{% extends 'layout.html' %}

{% block content %}
  {% if current_user.is_authenticated %}
      <form id="favorate" action="" method="post">
      {% if is_fan%}
        <input class="btn btn-secondary float-right btn-sm mt-2" type="submit" name="follow_action" value="Unfollow this user" >
      {% else %}
        <input class="btn btn-primary float-right btn-sm mt-2" type="submit" name="follow_action" value="Follow this user" >
      {% endif %}
    </form>
    {% endif %}


  <h4>Main page of user {{user['name'] }}</h4>


  <ul>
    <li style="padding:0.25em">
      <span class="badge badge-pill badge-primary">Yealping Since: 
        <span class="badge badge-light">{{user['yealping_since'] }}</span> 
      </span>
    </li>
    <li style="padding:0.25em">
      <span class="badge badge-pill badge-info">Number of fans: 
        <span class="badge badge-light">{{n_fans}}</span> 
      </span>
    </li>
  </ul>

  <div class="content-section">
    <p>This user has {{collections|length }} collection(s):
      <ul class="list-group">
        {% for collection in collections %}
          <li class="list-group-item list-group-item-light">
            <a href="{{url_for('user_collection', user_id = user['user_id'], collection_id = collection['collection_id'])}}">
              {{ collection['collection_name'] }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </p>
  </div>
  <p></p>
  
  <div class="content-section">
    <p>This user has {{reviews|length }} review(s): </p>
    {% for review in reviews %}
      <article class="media content-section">
        <img class="rounded-circle article-img" src="{{ url_for('static', filename='profile_pics/default.jpg') }}">
        <div class="media-body">
          <div class="article-metadata">
            
            
            
            <span class="badge badge-primary">Stars: {{review['stars']}}</span>
            on <a class="mr-1" href="{{ url_for('restaurant', business_id=review['business_id']) }}">{{ review['name'] }}</a>
            <small class="text-muted">{{ review['review_date'].strftime('%Y-%m-%d') }}</small>
          </div>  
          <p class="article-content">{{ review['detailed_review'] }}</p>
      </article>
    {% endfor %}
  </div>
{% endblock %}